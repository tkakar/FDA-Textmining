#first course of action is to load the entire json file, replace all \\" with \" and then read into pandas

import pandas as p
import json
import re, pprint
import xml.etree.ElementTree as ET
import sys
import HashableElement as he


def main():
    filename = sys.argv[1]
    raw = open(filename).read()

    raw = raw.strip()[1:-1].decode('string-escape') #lot happening here. first the raw text is strips of leading and trailing white space, then stripped of leading and trailing single quotes, and finally, all escape characters are corrected

    string_json = json.loads(raw)
    
    sentenceTimexTags = []
    
    for sentence in range(0,len(string_json['sentences'])):
        wordTimexTags = []
        for word in range(0,len(string_json['sentences'][sentence]['words'])):
            if 'Timex' in string_json['sentences'][sentence]['words'][word][1]:
                wordTimexTags.append(ET.fromstring(string_json['sentences'][sentence]['words'][word][1]['Timex']))
        sentenceTimexTags.append(wordTimexTags)

#we now have all the XML elements from the parsed string in a 2D list

    for sentence in sentenceTimexTags:
        for XMLword in sentenceTimexTags[sentence]:
            
            
            print(sntenceTimexTags)



if __name__ == '__main__':
    main()
